import { motion } from "framer-motion";
import Head from "next/head";
import { pageTransition } from "../animations";
import { Events, Hero } from "../containers";
import { Navbar, ParallaxImages } from "../components";
import sanityClient from "../sanityClient";
import { GetStaticProps } from "next";
import { Props } from "../containers/Events/types";

const Home = ({ events }: Props) => {
  return (
    <>
      <Navbar />
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <motion.section
        variants={pageTransition}
        initial="hidden"
        animate="visible"
        exit="exit"
      >
        <ParallaxImages />
        <Hero />
        <Events events={events} />
      </motion.section>
    </>
  );
};

export default Home;

export const getStaticProps: GetStaticProps = async () => {
  const events = await sanityClient.fetch(`*[_type == "event"] {
    name,
    caption,
    "poster": poster.asset->url
  }`);

  console.log(events);
  return {
    props: {
      events,
    },
  };
};
